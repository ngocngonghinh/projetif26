<?phpini_set('display_errors', 1);require_once('../model/contact.php');require_once('../model/message.php');require_once('../control/valideToken.php');$user = getUserFromToken();if ($user !== false) {    $list = array();    $contacts = $db->search('Contact', 'contact', 'initiator = :id OR contact = :id', array(':id' => $user->getId()));    foreach ($contacts as $contact) {        if ($user->getId() != $contact->getInitiator()) {            $contact->setContact($db->find('User', 'user', 'id = :id', array(':id' => $contact->getInitiator())));        } elseif ($user->getId() != $contact->getContact()) {            $contact->setContact($db->find('User', 'user', 'id = :id', array(':id' => $contact->getContact())));        }        $contact->setMessage($db->find('Message', 'message', 'contact = :contact', array(':contact' => (int) $contact->getId()), 'date desc'));        $list[] = $contact->simply();    }    $json = array(        'error' => false,        'contacts' => $list    );}echo json_encode($json);